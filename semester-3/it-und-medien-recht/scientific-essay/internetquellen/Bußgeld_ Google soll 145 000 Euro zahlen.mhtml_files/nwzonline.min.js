var nwzonlineApp=angular.module("nwzonline",["angularLazyImg","ngAnimate","angular-ladda","ngLoader","ngStorage","duScroll","ngTouch"]).config(["$provide",function(e){"ngInject";"/suche"!=location.pathname&&e.decorator("$browser",["$delegate",function(e){return e.onUrlChange=function(){},e.url=function(){return""},e}])}]).controller("MainCtrl",["$scope","$window","$location","$localStorage","$anchorScroll","$filter",function(e,t,n,a,i,o){a.$default({tabbedPorts:{},viewedObjects:{}}),e.datetime=new Date,e.staticView=!0,e.deleteViewedObjects=function(){a.viewedObjects={}},e.isRead=function(e,t){var n="";return t&&"undefined"!=typeof a.viewedObjects["R_"+e]&&(t=o("date")(1e3*t,"yyyy-MM-ddTHH:mm:ss.000Z"),n=new Date(t).getTime()>new Date(a.viewedObjects["R_"+e]).getTime()?"updated":"read"),n},e.backToTop=function(){i()}}]).controller("AsyncContentCtrl",["$scope",function(e){}]).directive("asyncLoad",[function(){return{restrict:"A",link:function(e,t,n){asyncType=n.asyncType?"async"+n.asyncType.charAt(0).toUpperCase()+n.asyncType.slice(1):"archive",n.trigger&&"instant"!=n.trigger?"lazy"==n.trigger?e.asyncContent="/"+asyncType+"/"+n.asyncLoad:console.log("Not loaded: "+n.trigger):e.asyncContent="/"+asyncType+"/"+n.asyncLoad}}}]).directive("phone",[function(){return{link:function(e,t,n){var a=t.html();t.html(n.type+' <a href="tel:'+a+'">'+a+"</a>")}}}]).controller("SearchHeadCtrl",["$scope",function(e){e.filterQ=function(){e.q=e.q.replace("@"," ");var t=e.q.toLowerCase();if(t.search(/\b[a|b]{1}[0-9]{6}\b/)!=-1||t.search(/\bmdx\-[a-z0-9]{7}\b/)!=-1||t.search(/\b^[0-9]{7}\b/)!=-1)return window.open("http://marktplatz.nwzonline.de/suche/onlineid/id/"+t,"_blank"),!1}}]).controller("AbocenterCtrl",["$scope","$http",function(e,t){var n=e;n.ssoId=ssoId,n.dear="Herr"==dear?"Lieber":"Liebe",n.customer=customer,n.currentUrl=currentUrl,n.meter="object"==typeof global_c1resp&&global_c1resp.data.count>0?global_c1resp.data.count:0,n.always_paid="undefined"!=typeof always_paid&&1==always_paid,n.triggerSSO=function(t){e.login={};new MSPSSOClass(t+"_formlogin",function(t){"401"==t.error.code&&(e.login.alert="Anmeldung fehlgeschlagen"),"201"==t.error.code&&(e.login.alert="Benutzername/E-mail oder Passwort falsch"),"700"!=t.error.code&&e.loginform.$setPristine(),e.$apply()});e.makeLogin=function(){e.login.alert=""}},n.$watch("tmpl",function(){}),n.start=function(){n.tmpl="/aboreg/5a"},n.start2=function(){n.tmpl="/aboreg/5b"},n.offer=function(){n.tmpl="/aboreg/5_offer"},n.reg=function(){n.tmpl="/aboreg/5_reg"},n.confirm=function(){n.tmpl="/aboreg/5_confirm"},n.ready=function(e,t){n.email=e,n.pass=t,n.tmpl="/aboreg/5_ready"},n.relogin=function(){n.tmpl="/aboreg/5_login"},n.freemium=function(){n.tmpl="/aboreg/5_freemium"},n.always_paid?n.freemium():null!=ssoId&&""!=ssoId?n.offer():n.meter>=11?n.relogin():n.meter>6?n.start2():n.start(),"undefined"!=sessionTemplateVariant&&(10006==sessionTemplateVariant&&(n.a1=n.a2=n.a3=!0),10010==sessionTemplateVariant&&(n.a1=n.a3=!0),10013==sessionTemplateVariant&&(n.a1=n.a2=n.a3=!0),10021==sessionTemplateVariant&&(n.a1=n.a2=n.a3=!0),10023==sessionTemplateVariant&&(n.a1=n.a2=n.a3=!0),10024==sessionTemplateVariant&&(n.a1=n.a2=n.a3=!0))}]).controller("RegCtrl",["$scope","$http",function(e,t){a=new Date,m=a.getMonth()+1,d=a.getDate(),e.today=a.getFullYear()+"-"+(m>9?m:"0"+m)+"-"+(d>9?d:"0"+d),e.busy=!1,e.isBusy=function(){return e.busy},e.getEmail=function(){return abc_dieemail},e.submitForm=function(){e.userForm.$valid&&0==e.busy&&(e.busy=!0,t({url:"/aboreg/register",method:"GET",params:{cli:abc_cli,m:"validate",email:e.email}}).then(function(t){return e.emailUsed=0!=t.data.code,e.busy=!1,0!=e.emailUsed?(e.userForm.email.$valid=!1,!1):(abc_dieemail=e.email,void e.register())},function(t){e.busy=!1}))},e.register=function(){a=new Date(e.bday),"Invalid Date"==a?e.birth="invalid":(m=a.getMonth()+1,d=a.getDate(),e.birth=a.getFullYear()+"-"+(m>9?m:"0"+m)+"-"+(d>9?d:"0"+d)),console.log("I",e.info?"1":"0"),t({url:"/aboreg/register",method:"GET",params:{cli:abc_cli,m:"submit",email:encodeURIComponent(abc_dieemail),name:e.name,surname:e.surname,gender:e.gender,info:e.info?"1":"0",birth:e.birth}}).then(function(t){abc_optInHash=t.data.optInHash,abc_userId=t.data.userId,abc_ttoken=t.data.tmpTokenValue,e.busy=!1,e.confirm()},function(t){e.busy=!1})},e.activateAccount=function(){e.busy=!0,t({url:"/aboreg/register",method:"GET",params:{cli:abc_cli,m:"optIn",optInHash:abc_optInHash,optInCode:e.optInCode}}).then(function(t){null==t.data||0!=t.data.code||"object"!=typeof t.data?(e.msg="test",e.msg="Es ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.",null!=t.data&&(e.msg=t.data.msg),e.activationError=!0):(e.activationError=!1,e.isActivated=!0,e.completeRegistration()),e.busy=!1},function(t){e.busy=!1})},e.completeRegistration=function(){1==e.isActivated&&(e.pw1!=e.pw2||null==e.pw1||null==e.pw2?e.pwderror="Passwörter dürfen nicht leer sein und müssen übereinstimmen":e.invalidPW?e.pwderror="Passwort enthält ungültige Zeichen":(e.pw1+"").length<8?e.pwderror="Das Passwort ist zu kurz. Mindestens 8 Zeichen erforderlich.":(e.busy=!0,t({url:"/aboreg/register",method:"GET",params:{cli:abc_cli,m:"setPw",password:e.pw1,userId:abc_userId,tmpTokenValue:abc_ttoken,userLogin:encodeURIComponent(abc_dieemail)}}).then(function(t){"false"!=t.data.code?(e.msg="Es ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.",e.busy=!1):(e.busy=!1,e.$parent.ready(abc_dieemail,e.pw1))},function(t){e.busy=!1})))},e.validPw=function(){var e=/.*[!"Â§$%&\/()=?*+#\-_:;,.]+.*/;return!!e.test($scpoe.pw1)},e.nlabo=function(){t({url:"http://abocenter.nwzonline.de/wp-content/themes/abocenter/newsletter/exitintent/",method:"jsonp",params:{key:"6A61B5134632CD72EAD89A2F37159",email:abc_dieemail,callback:"JSON_CALLBACK"}}).then(function(e){$("#conf_loginButton").click()},function(e){})}}]).factory("bookmarkService",["$localStorage","$http","$q",function(e,t,n){return{construct:function(){"undefined"!=typeof e.bookmarks&&null!=e.bookmarks||(e.bookmarks={Artikel:[],Fotos:[],Videos:[],pull:Math.ceil((new Date).getTime()/1e3)}),"undefined"==typeof e.bookmarks.pull&&(e.bookmarks.pull=Math.ceil((new Date).getTime()/1e3))},applyBookmarks:function(){return e.bookmarks},isStored:function(t,n){return e.bookmarks[n].indexOf("B"+t)!==-1},remove:function(t,n){this.pull(),e.bookmarks[n].indexOf("B"+t)!=-1&&(e.bookmarks[n].splice(e.bookmarks[n].indexOf("B"+t),1),this.apply())},add:function(t,n){this.pull(),e.bookmarks[n].indexOf("B"+t)==-1&&(e.bookmarks[n].unshift("B"+t),this.apply())},pull:function(a){now=Math.ceil((new Date).getTime()/1e3);var i=n.defer();return(e.bookmarks.pull+300<now||a)&&t({method:"POST",url:"/bms",async:!1,data:"m=get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){0==t.data.code&&(null!=t.data.bookmarks&&(e.bookmarks=t.data.bookmarks),e.bookmarks.pull=Math.ceil((new Date).getTime()/1e3)),i.resolve(e.bookmarks)},function(t){console.log("pull failed"),i.resolve(e.bookmarks)}),i.promise},apply:function(){t({method:"POST",url:"/bms",data:"m=set&bookmarks="+JSON.stringify(e.bookmarks),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]).controller("BookmarksCtrl",["$scope","$localStorage","bookmarkService",function(e,t,n){e.activeTab={},e.start=0,e.end=6,n.construct(),e.bookmarks=n.applyBookmarks(),e.browseTab=function(t,n,a){e.tabPage=e.tabPage+a,e.openTab(t,n,e.tabPage)},e.getNumLabel=function(t){return e.bookmarks[t].length},e.getItems=function(t,n,a){return e.bookmarks[t].slice(n,a)},e.openTab=function(n,a,i){e.storageId=a,e.tabPage=i||0,e.tabLength=e.bookmarks[n].length,end=e.end*(e.tabPage+1),start=e.end*e.tabPage,i=0==start&&e.tabLength>e.end?"first":e.tabLength<=e.end?"only":end<e.tabLength?e.tabPage:"last",e.tabIsLoading=!0,e.activeTab.title=n,e.tabContent="/asyncBookmarks/"+btoa(JSON.stringify({id:stvOriginal,title:n,items:e.getItems(n,start,end),page:i,sid:a,cachebuster:Math.ceil((new Date).getTime())})),t.tabbedPorts[a]=[n]},e.initTab=function(a,i){n.pull(!0).then(function(o){e.bookmarks=n.applyBookmarks(),"undefined"==typeof t.tabbedPorts&&(t.tabbedPorts=[],t.tabbedPorts[i]=[a]),ls=t.tabbedPorts[i],e.storageId=i,"undefined"!=typeof ls&&ls[0]!=a?e.openTab(ls[0],i):e.openTab(a,i)})},e.remove=function(t,a,i){n.remove(t,a),e.bookmarks[a].indexOf("B"+t)!=-1&&e.bookmarks[a].splice(e.bookmarks[a].indexOf("B"+t),1),i||(e.tabPage*e.end>=e.getNumLabel(a)?e.browseTab(a,e.storageId,-1):e.openTab(a,e.storageId,e.tabPage))},e.isActiveTab=function(t){return e.activeTab.title==t}}]).directive("bookmark",["bookmarkService",function(e){return{restrict:"A",controller:["$scope","$element","$attrs",function(t,n,a){e.construct(),t.id=a.bookmark;var i=a.type;t.setLabel=function(){t.label=e.isStored(t.id,i)?"isBookmark":""},n.bind("click",function(){e.pull(!0).then(function(n){e.isStored(t.id,i)?e.remove(t.id,i):e.add(t.id,i),t.setLabel(),t.$apply()})})}],link:function(e,t){10006!=sessionTemplateVariant||10006!=stvOriginal?e.setLabel():t.addClass("ng-hide")}}}]).controller("ContentportCtrl",["$scope","$localStorage",function(e,t){e.activeTab={},e.openTab=function(n,a,i,o){e.tabIsLoading=!0,e.activeTab.url=n,e.activeTab.title=a,e.tabContent="/asyncTeaserlist/"+i,t.tabbedPorts[o]=[n,a,i]},e.initTab=function(n,a,i,o){ls=t.tabbedPorts[o],"undefined"!=typeof ls&&ls[0]!=n?e.openTab(ls[0],ls[1],ls[2],o):e.openTab(n,a,i,o)},e.isActiveTab=function(t){return e.activeTab.url==t}}]).controller("ElectionCtrl",["$scope","$element","$document","$http","$localStorage",function(e,t,n,a,o){e.activeTab="",e.data=electionData,e.scrollToElement=function(e){var t=angular.element(document.getElementById(e));n.scrollTo(t,30,1e3)},e.openTab=function(t){e.activeTab=t},e.isActiveTab=function(t){return e.activeTab==t},e.vote=function(t,n,a){e.data[t].vote=a},e.submitVoting=function(){if(1==e.participated)return e.message="Sie haben an dieser Abstimmung bereits teilgenommen.",!1;var n=!1;for(e.message="Bitte wählen Sie in jeder Kategorie einen Favoriten.",i=0;i<e.data.length;i++)null==e.data[i].vote&&(n=!0);if(n)return!1;e.message="";var o="";for(i=0;i<e.data.length;i++)o+=e.data[i].cat+"|"+e.data[i].nominees[e.data[i].vote].name,i!=e.data.length-1&&(o+="#");a({url:"/spw-save",method:"post",params:{votingId:t.attr("id"),votes:o}}).success(function(t){e.message=t.message,"alreadyParticipated"==t.code&&(e.participated=!0)})}}]).controller("EventCtrl",["$scope","$timeout",function(e,t){e.tempestivaReady=!1,e.pageKeys=[{label:"Konzerte",pageKey:"fuerunentschlossene",data:[],isLoading:!0},{label:"Partys",pageKey:"fuerjungeleute",data:[],isLoading:!1},{label:"Familie",pageKey:"fuerfamilien",data:[],isLoading:!1}],e.setPageKey=function(n){e.eventsIsLoading=!0;var a=e.pageKeys[n];e.selectedPageKey=a.pageKey,0===a.data.length?(a.isLoading=!0,Tempestiva.Data.getFeaturedEventsByPageKey(a.pageKey,function(n){t(function(){a.isLoading=e.eventsIsLoading=!1,e.selectedData=a.data=n.data},300)},0)):(e.eventsIsLoading=!1,e.selectedData=a.data)},"undefined"!=typeof Tempestiva&&Tempestiva.isReady(function(){e.tempestivaReady=!0,e.setPageKey(0)})}]).filter("formatTime",["$filter",function(e){return function(e){return e.length>5?e.substr(0,e.length-3):e}}]).controller("ux9000gallery",["$scope","$swipe","$element","$timeout","$document","$window","$sce","$location","$anchorScroll",function(e,t,n,a,i,o,r,s,l){e.overlay=!1,e.ui=!0,l.yOffset=80,data=JSON.parse(i[0].getElementById("gdata").innerHTML),e.defaultView=n.attr("view"),e.setView=function(t,i){"undefined"!=typeof i&&(e.index=i,e.browse(0)),"reset"==t&&(t=e.defaultView,console.log(e.index),a(function(){s.hash("bild"+e.index),l()},0,!1)),e.toggleHeader(t),n.attr({view:t})},e.getView=function(){return n.attr("view")},e.toggleHeader=function(e){"overlay"==e?(i[0].getElementsByClassName("sticky")[0].style.display="none",i[0].getElementById("outer_container").style.paddingTop="0"):(i[0].getElementsByClassName("sticky")[0].style.display="block",i[0].getElementById("outer_container").style.paddingTop="60px")},e.getCaption=function(){return r.trustAsHtml(e.images[e.index].caption)};e.images=data.items,e.size=data.size,e.applyBoundsToOverlay=function(){console.log("bounds");var e=i[0].getElementsByTagName("GALLERY")[0];e.style.height=(window.outerHeight||window.innerHeight)+"px",e.style.width="100%"},e.applyBoundsToOverlay(),e.carousel=i[0].getElementsByClassName("car")[0],e.index=0,e.items=e.images.length,e.browse=function(t){a(function(){newIndex=e.index+t,1==t?e.index=newIndex<e.items?newIndex:0:e.index=newIndex>=0?newIndex:e.items-1,e.carousel.style.left=e.index*-100+"%",e.caption=e.images[e.index].caption,e.credit=e.images[e.index].credit,e.$apply()},0,!1)},angular.element(o).bind("orientationchange",function(){e.applyBoundsToOverlay()})}]).controller("gg",["$scope","$swipe","$element","$timeout","$document","$window","$sce",function(e,t,n,a,i,o,r){e.overlay=!1,e.ui=!0,data=JSON.parse(i[0].getElementById("gdata").innerHTML),e.defaultView=n.attr("view"),e.setView=function(t,a){e.carousel.setAttribute("animate","false"),"undefined"!=typeof a&&(e.index=a,e.browse(0,!0)),"reset"==t&&(t=e.defaultView),e.toggleHeader(t),n.attr({view:t})},e.getView=function(){return n.attr("view")},e.toggleHeader=function(e){i[0].getElementsByClassName("sticky").length>0&&("overlay"==e?(i[0].getElementsByClassName("sticky")[0].style.display="none",i[0].getElementById("outer_container").style.paddingTop="0"):(i[0].getElementsByClassName("sticky")[0].style.display="block",i[0].getElementById("outer_container").style.paddingTop="60px"))},e.getCaption=function(t){return r.trustAsHtml(e.images[t].caption)};var s=0;e.images=data.items,e.size=data.size,e.carousel=i[0].getElementsByClassName("car")[0],e.index=0,e.items=e.images.length,e.applyBoundsToOverlay=function(){var t=i[0].getElementsByClassName("overlay")[0];e.availableHeight=window.innerHeight||window.outerHeight,e.availableWidth=window.innerWidth||window.outerwidth,e.overlayFormat=e.availableHeight>e.availableWidth?"portrait":"landscape",t.style.height=e.availableHeight+"px",t.style.width="100%",a(function(){e.getFormat(e.images[e.index])},50)},e.getFormat=function(t){return w=t.size.image_online.width,h=t.size.image_online.height,renderHeight=!1,w>h?("landscape"==e.overlayFormat&&(neededHeight=e.availableWidth/w*h,neededHeight>e.availableHeight&&(renderHeight=!0)),"portrait"==e.overlayFormat&&(renderHeight=!0,neededWidth=e.availableHeight/h*w,neededWidth>e.availableWidth&&(renderHeight=!1))):("portrait"==e.overlayFormat&&(neededHeight=e.availableWidth/w*h,neededHeight>e.availableHeight&&(renderHeight=!0)),"landscape"==e.overlayFormat&&(renderHeight=!0,neededWidth=e.availableHeight/h*w,neededWidth>e.availableWidth&&(renderHeight=!1))),renderHeight?"h":""},e.applyBoundsToOverlay(),e.browse=function(t,i){"overlay"==n.attr("view")&&s++,a(function(){e.carousel.setAttribute("animate","false"),newIndex=e.index+t,1==t?newIndex<e.items?(i||e.carousel.setAttribute("animate","true"),e.index=newIndex):e.index=0:newIndex>=0?(i||e.carousel.setAttribute("animate","true"),e.index=newIndex):e.index=e.items-1,e.carousel.style.left=e.index*-100+"%",e.caption=e.images[e.index].caption,e.credit=e.images[e.index].credit,e.$apply(),e.applyBoundsToOverlay(),s>0&&s%5==0&&(console.log("ad"),"undefined"!=typeof googletag&&"undefined"!=typeof aSlot&&googletag.pubads().refresh([aSlot.galleryAd]))},0,!1)},window.onkeyup=function(t){return t.preventDefault(),"37"==t.keyCode&&e.browse(-1),"39"==t.keyCode&&e.browse(1),"27"==t.keyCode&&e.setView("reset"),!1},e.lazyImg=function(t,n){if(n==e.index-1||n==e.index||n==e.index+1)return t},angular.element(o).bind("resize",function(){e.applyBoundsToOverlay()}),angular.element(o).bind("orientationchange",function(){e.applyBoundsToOverlay()})}]).controller("GuideCtrl",["$scope","$timeout",function(e,t){guideProfiles.data&&(guideProfiles.data.data.length>3?e.Profiles=guideProfiles.data.data.slice(0,3):e.Profiles=guideProfiles.data.data),e.getImage=function(e){var t="";return e.bilder.length>0?(angular.forEach(e.bilder,function(n,a){"100"==n.flags&&(t="https://guide.nwzonline.de/images/profil/"+e.id+"/carouselthumb/"+n.name)}),""==t&&(t="https://guide.nwzonline.de/images/profil/"+e.id+"/carouselthumb/"+e.bilder[0].name)):t="https://guide.nwzonline.de/images/profilbild-dummy.jpg",t},e.login={},e.search=function(){(e.login.was.length>0||e.login.wo.length>0)&&window.open("https://guide.nwzonline.de/suche/liste?was="+(e.login.was||"")+"&wo="+(e.login.wo||""),"_blank")}}]).controller("LoginCtrl",["$scope","$http","$element",function(e,t,n){e.login={},console.log("loginctrl"),e.currentUrl="undefined"!=typeof siteUrl?siteUrl:"/";new MSPSSOClass(n.attr("id"),function(t){"401"==t.error.code&&(e.login.alert="Anmeldung fehlgeschlagen"),"201"==t.error.code&&(e.login.alert="Benutzername/E-mail oder Passwort falsch"),"700"!=t.error.code&&e.loginform.$setPristine(),e.$apply()});e.makeLogin=function(){console.log("ml-l26"),e.login.alert=""}}]).controller("MailCtrl",["$scope","$http",function(e,t){e.mail={},e.sendMailForm=function(){var n={params:e.mail};t.get("/emailhandler",n).success(function(t,n,a,i){t.indexOf("success")!=-1&&(e.$emit("reset",!1),e.mail.firstname="",e.mail.lastname="",e.mail.email="",e.mail.body="",e.mailform.$setUntouched(),e.mailform.$setPristine())}).error(function(e,t,n,a){console.log("error",e,t,n,a)})}}]).controller("NaviCtrl",["$scope","$http","SHARING","$element",function(e,t,n,a){var i=null!=navigator.userAgent.match(/iPad/i);i&&(angular.forEach(a.find("[href]"),function(e){angular.element(e).attr("ipad","false")}),angular.forEach(a.find(".navigation__sub__sub [href]"),function(e){angular.element(e).removeAttr("ipad")}),angular.forEach(a.find(".tabrow [href]"),function(e){angular.element(e).removeAttr("ipad")}),angular.forEach(a.find("[ipad]"),function(e){var e=angular.element(e);"A"==e[0].tagName&&e.bind("click",function(){if("false"==e.attr("ipad")){var t=document.querySelectorAll('[ipad="true"]');return t.length>0&&t[0].setAttribute("ipad","false"),e.attr("ipad","true"),!1}return!0})})),e.nwznavi=nwznavi,e.SHARING=n}]).directive("zipper",[function(){return{link:function(e,t,n){t[0].style.marginTop=t[0].offsetHeight*-1+"px"}}}]).controller("mobileNavCtrl",["$scope",function(e){e.tab=1,e.setTab=function(t){e.tab=t,document.getElementById("sidenav").scrollTop=0},e.getML=function(t){return{"margin-left":-100*(e.tab-t)+"%"}}}]).controller("ReadCtrl",["$scope","$localStorage",function(e,t){var n=[];for(var a in t.viewedObjects)n.push(a.replace("R_",""));n=n.reverse(),e.tid="","undefined"!=typeof global_c1resp&&(e.tid=global_c1resp.data.tracking_id),cre_client.addListener(function(t){"undefined"!=typeof t.data.tracking_id&&(e.tid=t.data.tracking_id)});var i=window.btoa(JSON.stringify({loids:n.join(",")}));e.template="/asyncRead/"+i}]).directive("recommendations",["$localStorage",function(e){return{scope:{channel:"@",chars:"@",additionalAttr:"@"},template:'<ng-include src="getTemplate()" />',controller:["$scope",function(e){e.getTemplate=function(){return e.template}}],link:function(t,n,a){var i=[];for(var o in e.viewedObjects)i.push(o.replace("R_","!eom_id:")+"%20AND%20");async=window.btoa(JSON.stringify({title:"",path:"/_facelift/widgets/story/recommendations.widget.jpt",modifier:"--recommendation",containerAdditionalAttr:t.additionalAttr,params:{channel:t.channel,chars:t.chars,search:i}})),t.template="/asyncWidget/"+async}}}]).controller("SortPortCtrl",["$scope","$localStorage",function(e,t){e.appliedSort=!1,e.prefs=null,e.status=t,e.status.personalHome=!0,e.$watch("status.personalHome",function(t){e.pSort(t)}),e.pSort=function(n){if(t.personalHome=n,console.log(n,typeof cre_client,sessionTemplateVariant,e.prefs),n&&"undefined"!=typeof cre_client&&null!=e.prefs){var a=[],i=[];if(null!=e.prefs&&"object"==typeof prefContainer){prefContainer.map(function(t,n){t.fix===!0&&e.prefs.values.splice(n,0,t.id)}),prefContainer.map(function(t,n){var o=e.prefs.values.indexOf(t.id);o<0?i[1e3*n]=t.id:a[o]=t.id}),a=a.concat(i);var o=0;a.map(function(e,t){var e;prefContainer.forEach(function(t){for(;"undefined"!=typeof prefContainer[o]&&"undefined"!=typeof prefContainer[o].fix&&1==prefContainer[o].fix;)prefContainer[o].fix="set",cp=document.getElementById(prefContainer[o].id),null!=cp&&(cp.style.order=o),o++;t.id==e&&1!=t.fix&&(cp=document.getElementById(t.id),null!=cp&&(cp.style.order=o),o++)})})}}else prefContainer.forEach(function(e,t){cp=document.getElementById(e.id),"set"==e.fix&&(e.fix=!0),null!=cp&&(cp.style.order="")});e.appliedSort=!0},e.init=function(){cre_client.addListener(function(t){"undefined"!=typeof t.data.affinity_sequences&&t.data.affinity_sequences.map(function(t){"unifiedChannels"==t.id&&(e.prefs=t)}),e.pSort(!0)})},e.init()}]).controller("SporttabellenCtrl",["$scope","$timeout","SporttabellenAPI","$localStorage","$sessionStorage",function(e,t,n,a,i){function o(t){var n={position:"Pl.",trend:" ",team:"Verein",played:"Spiele",points:"Punkte",goalDifference:"Diff.",goals:"Tore",won:"G",draw:"U",lost:"V"},a={position:"Pl.",trend:" ",team:"Verein",played:"Sp.",points:"Pkt.",goalDifference:"Diff.",goals:"Tore",won:"G",draw:"U",lost:"V"},i=[],o=[];i[1]={},o[1]={},i[2]={},o[2]={},i[3]={played:"Begegnungen",points:"Tab. Punkte",goals:"Matchpunkte"},o[3]={played:"Begegn.",points:"Tab. Pkt.",goals:"Matchpkt."},i[4]={},o[4]={},i[5]={played:"gespielt",goals:"Spiele"},o[5]={played:"gesp.",goals:"Sp."},i[6]={goals:"Körbe",draw:""},o[6]={},i[7]={},o[7]={},i[8]={},o[8]={},i[9]={},o[9]={},i[10]={},o[10]={},i[11]={},o[11]={},i[12]={},o[12]={},i[13]={},o[13]={},i[14]={goals:"Schoet"},o[14]={},i[15]={},o[15]={},i[16]={},o[16]={},i[22]={},o[22]={},i[6111]={goals:"Spielpunkte"},o[6111]={goals:"Spielpkt."},i[6288]={},o[6288]={},i[6291]={goals:"Körbe",draw:""},o[6291]={},i[7718]={goals:"Spiel"},o[7718]={},"small"==e.size&&(i=o,n=a);var r=i[t];return Object.keys(r).length>0&&angular.forEach(r,function(e,t){""!=e?n[t]=e:delete n[t]},this),n}e.$storage=a,e.toggleContent="",e.setSports=function(){null!=e.sport.sport&&1==e.sport.sport.data.length&&(e.sport.type=e.sport.sport.data[0],e.setType())},e.setType=function(){null!=e.sport.type&&1==e.sport.type.data.length&&(e.sport.category=e.sport.type.data[0],e.setCategory())},e.setCategory=function(){null!=e.sport.category&&1==e.sport.category.numLeagues&&(e.sport.league=e.sport.category.data[0],iom.c(iam_data,1),e.setLeague())},e.setResult=function(){e.sportsMatches=e.matchDay.matches,iom.c(iam_data,1)},e.setContentType=function(t){e.contentType=t},e.setLeague=function(){if(null!=e.sport.league){e.loading=!0;var t={typ:"liga",liga_id:e.sport.league.id};n.get(t).then(function(a){var i=a.data.tabelle;i.heading=e.sport.sport.heading,e.$storage.initLeagueId=a.data.LIGA_ID,t={typ:"plan",liga_id:e.sport.league.id},n.get(t).then(function(t){var n=[];angular.forEach(t.data.matchDays,function(e,t){var a=e.matchDay;n[a]=n[a]||[],n[a].matches=n[a].matches||[],n[a].matchDay=e.matchDay,angular.forEach(e.matches,function(t,i){n[a].matchDay=e.matchDay,n[a].matches.push(t)},this)},this),e.sportsMatchDays=n;var a=0==t.data.matchDayCurrent?1:t.data.matchDayCurrent;e.matchDay={},e.matchDay.matches=e.sportsMatchDays[a],e.sportsMatches=e.matchDay.matches,e.sportsTable=i})["catch"](function(e){console.log("error"),console.error(e)})["finally"](function(){e.loading=!1})})["catch"](function(e){console.log("error"),console.error(e)})["finally"](function(){e.loading=!1})}},e.sport={};var r=window.location.search.substring(1),s=r.split("&"),l=s[0].split("=");"liga"==l[0]&&(e.$storage.initLeagueId=l[1]),e.$storage.initLeagueId||(e.$storage.initLeagueId=8909);var c,d,u,p,g=e.$storage.initLeagueId;e.sports={};var f={typ:"ft2"};e.init=function(t){t&&(g=t),n.get(f).then(function(t){var n=t.data.sports,a=[],i="",r=-1,s=-1,l="",f="",m=-1,h="",b="";angular.forEach(n,function(e,t){i!=e.name&&(r++,i=e.name,a[r]={id:e.id,name:i,heading:o(e.id),data:[],numLeagues:0},s=-1,f="",b="");var n=e.groups[0],y=n.name.split("|");y.length>1&&(l=y[0].trim(),h=y[1].trim(),l!=f&&(leaguesTypeCountLeagues=0,s++,f=l,a[r].data[s]={name:l,data:[],numLeagues:0},m=-1,b=""),h!=b&&(m++,b=h,a[r].data[s].data[m]={name:h,data:[],numLeagues:0},angular.forEach(n.leagues,function(e,t){a[r].data[s].data[m].data.push(e),a[r].numLeagues++,a[r].data[s].numLeagues++,a[r].data[s].data[m].numLeagues++,e.id==g&&(c=r,d=s,u=m,p=t)},this)))},this),e.sports=a,e.sport.sport=e.sports[c],e.sport.type=e.sport.sport.data[d],e.sport.category=e.sport.type.data[u],e.sport.league=e.sport.category.data[p],e.sport.league.id=g,e.setLeague()})["catch"](function(e){console.error(e)})["finally"](function(){})}}]).service("SporttabellenAPI",["$location","$http",function(e,t){this.get=function(e){return e.serie=10,t.get("https://msusportv4.medien-systempartner.de/nwzonline.php",{method:"GET",params:e})}}]).filter("matchdayoptions",function(){return function(e){return void 0===e?"":e+". Spieltag"}}).directive("sporttabellen",[function(){return{controller:"SporttabellenCtrl",controllerAs:"ctrl",scope:{type:"="},templateUrl:"/facelift/assets/templates/sporttabellen.tmpl.html",link:function(e,t,n,a,i){e.navDepth=n.scNavDepth||0;var o=n.scTabInit||"both";e.setContentType(o),e.size=n.scSize||"small",e.init(n.scLeagueId)}}}]).controller("StoryCtrl",["$scope","SHARING","$localStorage","$element","$filter",function(e,t,n,a,i){e.SHARING=t,e.SHARING.setStatus(!0),e.SHARING.setTitle(a.attr("sharingtitle"));var o="R_"+a.attr("loid");for(n.viewedObjects[o]=new Date;Object.keys(n.viewedObjects).length>20;){var r=new Date;angular.forEach(n.viewedObjects,function(e,t){new Date(e).getTime()<r.getTime()&&(r=new Date(e),delete n.viewedObjects[t])})}}]).controller("SearchCtrl2",["$scope","$location",function(e,t){e.page=parseInt(0),e.actualState=!1,e.allTypes=!0,e.type={story:!1,gallery:!1,video:!1},e.searchSubmit=function(n){if(n||e.searchString!=e.q&&(e.page=0,iom.c(iam_data,1)),e.searchString=e.q,t.path("/s="+btoa(JSON.stringify({q:e.q,p:e.page}))),""==e.q||"undefined"==typeof e.q)return!1;var a=[];angular.forEach(e.type,function(e,t){e&&a.push("type:"+t)});var i=a.join(" || ")||null;e.searchResult="/asyncSearchResult/"+btoa(JSON.stringify({p:parseInt(e.page),fq:i,q:btoa(encodeURIComponent(e.q))})),e.actualState!=e.searchResult&&(e.searchInProgress=!0,e.actualState=e.searchResult)},e.reset=function(){e.q="",e.allTypes=!0,e.type={story:!1,gallery:!1,video:!1},e.searchResult=""},e.loadMore=function(t){return e.searchResult="",e.searchInProgress=!0,e.page=e.page+(t?1:-1),e.searchSubmit(),scrollTo(0,111),iom.c(iam_data,1),!1};var n=[];e.$watch("allTypes",function(){e.allTypes&&(e.type={story:!1,gallery:!1,video:!1})}),e.$watchCollection("type",function(){n=[],angular.forEach(e.type,function(t,a){t&&(e.allTypes=!1,n.push(a))}),0==n.length&&(e.allTypes=!0)}),e.checkTypes=function(){return e.allTypes&&0==n.length};var i=!1;t.path().indexOf("/s=")!=-1?(hp=JSON.parse(atob(t.path().split("/s=")[1])),hp.q&&(e.q=hp.q,i=!0),hp.p&&(e.page=hp.p)):location.search.indexOf("?")!=-1&&(qs=location.search.split("?")[1],kv=qs.indexOf("&")!=-1?qs.split("&"):[qs],kv.map(function(t){a=t.split("="),"q"==a[0]&&(e.q=decodeURIComponent(a[1]),i=!0),"p"==a[0]&&parseInt(a[1])==a[1]&&(e.page=parseInt(a[1]))})),i&&e.searchSubmit(!0)}]).directive("switch",[function(){return{restrict:"AE",replace:!0,transclude:!0,template:function(e,t){var n="";return n+="<span",n+=' class="switch'+(t["class"]?" "+t["class"]:"")+'"',n+=t.ngModel?' ng-click="'+t.disabled+" ? "+t.ngModel+" : "+t.ngModel+"=!"+t.ngModel+(t.ngChange?"; "+t.ngChange+'()"':'"'):"",n+=' ng-class="{ checked:'+t.ngModel+' }"',n+=">",n+="<small></small>",n+='<input type="checkbox"',n+=t.id?' id="'+t.id+'"':"",n+=t.name?' name="'+t.name+'"':"",n+=t.ngModel?' ng-model="'+t.ngModel+'"':"",n+=' style="display:none" />',n+='<span class="switch-text">',n+=t.on?'<span class="on">'+t.on+"</span>":"",n+=t.off?'<span class="off">'+t.off+"</span>":" ",n+="</span>"}}}]).directive("natContainer",["$timeout","$http",function(e,t){return{scope:{},link:function(n,a,i){n.singleton=!1,n.a=a.children().length,console.log("A",n.a),e(function(){console.log("B",n.a,a.children().length),n.a!=a.children().length||0!=a.children().length||n.singleton||t.get("/asyncStatic/"+window.btoa("/_facelift/widgets/ads/advertorial.default.widget.jpt")).then(function(e){a.html(e.data)}),n.singleton=!0},3500)}}}]).directive("fab",["$window",function(e){return{link:function(t,n,a){t.article=n.parent(),window.addEventListener("scroll",function(){pposTop=t.article[0].getBoundingClientRect().top,pposBottom=t.article[0].getBoundingClientRect().bottom,pposTop<0?n.addClass("active"):n.removeClass("active"),pposBottom-e.innerHeight<0?n.addClass("top"):n.removeClass("top")})}}}]).directive("jsonGallery",[function(){return{restrict:"E",link:function(e,t,n){if(e.disabled=!1,"undefined"!=n.disabled&&null!=n.disabled&&(e.disabled=!0),console.log("AAA",n.disabled),"undefined"!=window[n.data]&&null!=window[n.data]){var a=0;e.images=window[n.data].items,e.size=n.size;var i=t.find("counter"),o=t.find("credit");if(e.images.length>1){var r=t.find(".prev");r.addClass("icon__arrow-left--48").bind("click",function(t){t.preventDefault(),e.browse(-1)}).bind("mouseover",function(){r.addClass("icon__arrow-left_hover--48"),r.removeClass("icon__arrow-left--48")}).bind("mouseout",function(){r.addClass("icon__arrow-left--48"),r.removeClass("icon__arrow-left_hover--48")});var s=t.find(".next");s.addClass("icon__arrow-right--48").bind("click",function(t){t.preventDefault(),e.browse(1)}).bind("mouseover",function(){s.addClass("icon__arrow-right_hover--48"),s.removeClass("icon__arrow-right--48")}).bind("mouseout",function(){s.addClass("icon__arrow-right--48"),s.removeClass("icon__arrow-right_hover--48")})}else{var r=t.find(".prev");r.html("");var s=t.find(".next");s.html("")}if(t.find("img").bind("click",function(t){t.preventDefault(),e.browse(1)}),e.img=t.find("img")[0],e.cap=t.find("figcaption")[0],e.index=gindex||0,e.items=e.images.length,e.initialCall=!0,e.gtmPush=!1,0==e.items)return!1;e.img.src=e.images[e.index].size[e.size].src,e.cap.innerHTML=e.images[e.index].caption,e.items>1&&i.html(e.index+1+" / "+e.items),e.display=function(){e.img.src=e.images[e.index].size[e.size].src,e.cap.innerHTML=e.images[e.index].caption,o.html("Bild: "!=e.images[e.index].credit?e.images[e.index].credit:""),0==e.initialCall&&iom.c(iam_data,1),e.initialCall=!1},e.browse=function(t){return!e.disabled&&(a++,newIndex=e.index+t,1==t?e.index=newIndex<e.items?newIndex:0:e.index=newIndex>=0?newIndex:e.items-1,a%5==0&&console.log("ad"),e.items>1&&i.html(e.index+1+" / "+e.items),e.$apply(),void e.display())},window.onkeyup=function(t){return t.preventDefault(),"37"==t.keyCode&&e.browse(-1),"39"==t.keyCode&&e.browse(1),!1},e.display()}}}}]).directive("gallery",[function(){return{restrict:"E",link:function(e,t,n){if(e.disabled=!1,"undefined"!=n.disabled&&null!=n.disabled&&(e.disabled=!0),console.log("AAA",n.disabled),"undefined"!=window[n.data]&&null!=window[n.data]){var a=0;e.images=window[n.data];var i=t.find("counter"),o=t.find("credit");if(e.images.length>1){var r=t.find(".prev");r.addClass("icon__arrow-left--48").bind("click",function(t){t.preventDefault(),e.browse(-1)}).bind("mouseover",function(){r.addClass("icon__arrow-left_hover--48"),r.removeClass("icon__arrow-left--48")}).bind("mouseout",function(){r.addClass("icon__arrow-left--48"),r.removeClass("icon__arrow-left_hover--48")});var s=t.find(".next");s.addClass("icon__arrow-right--48").bind("click",function(t){t.preventDefault(),e.browse(1)}).bind("mouseover",function(){s.addClass("icon__arrow-right_hover--48"),s.removeClass("icon__arrow-right--48")}).bind("mouseout",function(){s.addClass("icon__arrow-right--48"),s.removeClass("icon__arrow-right_hover--48")})}if(t.find("img").bind("click",function(t){t.preventDefault(),e.browse(1)}),e.img=t.find("img")[0],e.cap=t.find("figcaption")[0],e.index=gindex||0,e.items=e.images.length,e.initialCall=!0,e.gtmPush=!1,
0==e.items)return!1;e.img.src=e.images[e.index].src,e.cap.innerHTML=e.images[e.index].caption,e.items>1&&i.html(e.index+1+" / "+e.items),e.display=function(){e.img.src=e.images[e.index].src,e.cap.innerHTML=e.images[e.index].caption,o.html("Bild: "!=e.images[e.index].credit?e.images[e.index].credit:""),0==e.initialCall&&iom.c(iam_data,1),e.initialCall=!1},e.browse=function(t){return!e.disabled&&(a++,newIndex=e.index+t,1==t?e.index=newIndex<e.items?newIndex:0:e.index=newIndex>=0?newIndex:e.items-1,a%5==0&&console.log("ad"),e.items>1&&i.html(e.index+1+" / "+e.items),e.$apply(),void e.display())},window.onkeyup=function(t){return t.preventDefault(),"37"==t.keyCode&&e.browse(-1),"39"==t.keyCode&&e.browse(1),!1},e.display()}}}}]).directive("modal",["$document","$sce",function(e,t){var n="https://img.nwzonline.de",n="/facelift/assets/templates/";return{restrict:"E",link:function(e,t,a,i,o){e.modal=a,e.buttonicon=e.buttonicon||"","email"==a.type?e.modal.tmpl=n+"email.tmpl.html":"info"==a.type&&(e.modal.tmpl=n+"info.tmpl.html"),e.modalButtonShow=!0,t.css({display:"inline-block"})},scope:{type:"="},replace:!1,transclude:!0,templateUrl:"/facelift/assets/templates/modald.html",controller:["$scope","$attrs","$transclude",function(e,t,n){e.toggle=function(){e.$emit("reset",!0),e.modalShow=!e.modalShow;var t=angular.element(document.querySelector("body"));e.modalShow?t.attr("class","modal-open"):t.removeAttr("class","modal-open")},e.$on("reset",function(t,n){e.resetModal=n}),"true"==t.test&&e.toggle()}]}}]).directive("smartLink",[function(){return{scope:{ipad:"="},link:function(e,t,n){t.bind("click",function(){if(null!=t[0].getAttribute("ipad")&&"true"!=t[0].getAttribute("ipad")){var e=document.querySelectorAll('[ipad="true"]');return e.length>0&&e[0].setAttribute("ipad","false"),t[0].setAttribute("ipad","true"),!1}"undefined"!=typeof n.target?window.open(n.href,n.target):location.href=n.href})}}}]).directive("time",["$filter",function(e){return{link:function(t,n){n[0].innerHTML=e("date")(new Date,"dd.MM.yyyy - HH:mm")}}}]).service("SHARING",[function(){this.title=null,this.status=!1,this.getTitle=function(){if(this.status)return this.title},this.setTitle=function(e){this.title=e},this.setStatus=function(e){this.status=e},this.printView=function(){}}]).directive("sticky",[function(){return{link:function(e,t,n){function a(){var e=getComputedStyle(l),t=b?"top:"+m:"bottom:"+g,n=l.parentNode,a=l.nextSibling;u.appendChild(l),n&&n.insertBefore(u,a),u.setAttribute("style","display:"+e.display+";_height:"+l.offsetHeight+"px;margin:"+e.margin+";width:"+l.offsetWidth+"px"),l.setAttribute("style","left:"+y.left+"px;margin:0;position:fixed;transition:none;"+t+"px;width:"+e.width)}function i(){var e=u.parentNode,t=u.nextSibling;e.removeChild(u),e.insertBefore(l,t),null===p?l.removeAttribute("style"):l.setAttribute("style",p),u.removeAttribute("style"),b=h=!1}function o(){b||h?(y=u.getBoundingClientRect(),h=!isNaN(g)&&y.top>d.innerHeight-g-u.offsetHeight,b=!isNaN(m)&&y.top<m,b||h||i()):f.matches&&(y=l.getBoundingClientRect(),h=!isNaN(g)&&y.top>d.innerHeight-g-l.offsetHeight,b=!isNaN(m)&&y.top<m,(b||h)&&a())}function r(){(b||h)&&i(),o()}function s(){r(),d.removeEventListener("scroll",o),d.removeEventListener("resize",r)}var l=t[0],c=l.ownerDocument,d=c.defaultView,u=c.createElement("span"),p=l.getAttribute("style"),g=parseFloat(n.stickyBottom),f=d.matchMedia(n.stickyMedia||"all"),m=parseFloat(n.stickyTop),h=!1,b=!1,y={};u.className="is-sticky",d.addEventListener("scroll",o),d.addEventListener("resize",r),e.$on("$destroy",s),o()}}}]);